<html>
<head>
<title>几个原版着色器示例 - Minecraft(我的世界)中文论坛 - Powered by Discuz!</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
body 	   {margin: 10px 80px;}
body,table {font-size: FONTSIZE; font-family: FONT;}
h1 { font-size: 24px; margin-bottom: 20px; color: #999; }
</style>
<script src="data/cache/common.js?LPb" type="text/javascript"></script>
<script src="data/cache/forum_viewthread.js?LPb" type="text/javascript"></script>
<script type="text/javascript">var STYLEID = '30', STATICURL = 'static/', IMGDIR = 'template/mcbbs/image', VERHASH = 'LPb', charset = 'UTF-8', discuz_uid = '2419486', cookiepre = 'ZxYQ_8cea_', cookiedomain = '.mcbbs.net', cookiepath = '/', showusercard = '1', attackevasive = '0', disallowfloat = 'newthread|tradeorder|nav|usergroups', creditnotice = '1|人气|点,2|金粒|粒,3|金锭|块,4|宝石|颗,5|下界之星|枚,6|贡献|份,7|爱心|心,8|钻石|颗', defaultstyle = './template/mcbbs/style/nether', REPORTURL = 'aHR0cHM6Ly93d3cubWNiYnMubmV0L3RocmVhZC05MTc2NzktMS0xLmh0bWw/YWN0aW9uPXByaW50YWJsZQ==', SITEURL = 'https://www.mcbbs.net/', JSPATH = 'data/cache/';</script>
</head>

<body>
<h1>Minecraft(我的世界)中文论坛</h1>
<b>标题: </b>几个原版着色器示例 <b><a href="###" onclick="this.style.visibility='hidden';window.print();this.style.visibility='visible'">[打印本页]</a></b></span><br />
<script type="text/javascript">var zoomstatus = 0;var aimgcount = new Array();</script><hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>SPGoding&nbsp; &nbsp; <b>时间: </b>2019-10-3 22:57<br />
<b>标题: </b>几个原版着色器示例<br /><i class="pstatus"> 本帖最后由 SPGoding 于 2019-10-4 18:53 编辑 </i><br />
<br />
<font size="3"></font><br />
<br />
<font size="3">前日，本人发布了译文<a href="https://www.mcbbs.net/thread-916150-1-1.html" target="_blank">原版着色器指导</a>，其中涉及到了几个有趣的着色器实例，现将相关解析一并发布到技巧版。</font><br />
<br />
<font size="3">建议收藏本帖，本人会在后续更新时使用论坛的通知功能向收藏者发送提醒。另外，请等本人全帖更新完成后再评分，免得我半路咕了。</font><br />
<br />
<font size="3"></font><br />
<br />
<font size="6"><strong>屏幕方块</strong></font><br />
<br />
<font size="3"><img id="aimg_kKUqu" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/09/28/APdCim8rUMI1pTz.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">作者：<a href="https://www.mcbbs.net/plugin.php?id=link_redirect&target=https%3A%2F%2Fwww.reddit.com%2Fuser%2FSirBenet%2F" target="_blank">u/SirBenet</a></font><br />
<br />
<font size="3">原帖：<a href="https://www.mcbbs.net/plugin.php?id=link_redirect&target=https%3A%2F%2Fwww.reddit.com%2Fr%2FMinecraft%2Fcomments%2F9hj1l3%2Fa_screen_that_displays_what_youre_seeing_in%2F" target="_blank">reddit</a></font><br />
<br />
<font size="3">功能：在玩家视野中有发光的实体时，在品红色羊毛上显示玩家屏幕。</font><br />
<br />
<font size="3">原理：</font><br />
<br />
<font size="3">作者首先修改了品红色羊毛的材质为一张 256×256 的图片：</font><br />
<br />
<font size="3"><img id="aimg_m2ClZ" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/09/29/Ljg7s2VFpOmQkfW.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">这是一张看似魔幻，实则非常魔幻的图片。</font><br />
<br /><div class="quote"><blockquote><font size="3">为了与着色器保持统一，本文随后采用 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(r, g, b, o)</font></font>（分别代表红色、绿色、蓝色、不透明度）的方式表示颜色，每个数字的取值均为 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">0.0</font></font> 至 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">1.0</font></font>。如果不透明度为 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">1.0</font></font>，本文中会将其省略不写。</font></blockquote></div><br />
<font size="3">这张图片左下角那个像素的颜色为红色 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(1.0, 0.0, 0.0)</font></font>，左上角的像素为紫色 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(1.0, 0.0, 1.0)</font></font>，右下角的像素为黄色 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(1.0, 1.0, 0.0)</font></font>，右上角的像素为白色 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(1.0, 1.0, 1.0)</font></font>，其余像素的颜色通过插值计算：</font><br />
<br />
<font size="3"><img id="aimg_OE3n6" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/09/29/OfcUi9XnGuxTgrl.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">可以发现，这张图片中所有像素的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 通道均为 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">1.0</font></font>，而 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">g</font></font> 和 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">b</font></font> 通道则看起来有些眼熟。没错，它们<strong>与屏幕坐标的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">x</font></font> 与 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">y</font></font> 完全对应</strong>（下图来自<a href="https://www.mcbbs.net/thread-916150-1-1.html" target="_blank">原版着色器指导</a>）：</font><br />
<br />
<font size="3"><img id="aimg_XyE7Q" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/09/28/c7WE8yQUFjdZoDO.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">通过这样一张图片，作者极其巧妙地将羊毛材质上的每个像素对应到了玩家屏幕上的像素：</font><br />
<br /><div class="quote"><blockquote><font size="3">品红色羊毛材质上一个像素的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">x</font></font>、<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">y</font></font> 坐标 -&gt; 该颜色的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">g</font></font>、<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">b</font></font> 通道 -&gt; 玩家屏幕上像素的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">x</font></font>、<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">y</font></font> 坐标。</font></blockquote></div><br />
<font size="3">不过这时又有了一个问题：<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">g</font></font>、<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">b</font></font> 通道的功能已经知道了，为什么 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 通道要固定为 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">1.0</font></font> 呢？这是为了让后续着色器能够知道，这个像素是属于品红色羊毛材质上的，确实应当复制玩家屏幕上的像素到这里。如果着色器不对 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 通道进行限制，那么玩家屏幕上所有的像素都会按照 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">g</font></font>、<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">b</font></font> 通道的值显示为屏幕上对应坐标的像素：</font><br />
<br />
<font size="3"><img id="aimg_sB5n8" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/09/29/V5gny3Tc8rKMGtQ.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3"><img id="aimg_OqOyS" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/09/29/uFoErDVBgZp46yP.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">现在在游戏中已经得到了这样一个方块：</font><br />
<br />
<font size="3"><img id="aimg_BJGzO" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/03/KRcJaxBib86Uu19.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">接下来所要做的，就是编写一个片段着色器：检测当前像素的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 通道是否为 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">1.0</font></font>，如果是，则返回屏幕 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(g, b)</font></font> 位置的像素，否则返回正常的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">(x, y)</font></font> 位置的像素。</font><br />
<br />
<font size="3">片段着色器 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">assets/minecraft/shaders/program/screens.fsh</font></font>：</font><br />
<br /><div class="blockcode"><div id="code_tz6"><ol><li>#version 120<br /><li><br /><li>uniform sampler2D DiffuseSampler;<br /><li><br /><li>varying vec2 texCoord;<br /><li>varying vec2 oneTexel;<br /><li><br /><li>void main() {<br /><li>&nbsp; &nbsp; vec4 currentPixel = texture2D(DiffuseSampler, texCoord);<br /><li>&nbsp; &nbsp; if (currentPixel.r == 1.0) {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;vec2 coordFromColor = currentPixel.gb;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;gl_FragColor = texture2D(DiffuseSampler, coordFromColor);<br /><li>&nbsp; &nbsp; } else {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;gl_FragColor = texture2D(DiffuseSampler, texCoord);<br /><li>&nbsp; &nbsp; }<br /><li>}</ol></div><em onclick="copycode($('code_tz6'));">复制代码</em></div><br />
<font size="3">接下来还需要编写一个调用该片断着色器的着色器程序 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">assets/minecraft/shaders/program/screens.json</font></font>：</font><br />
<br /><div class="blockcode"><div id="code_Q3T"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;blend&quot;: {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;func&quot;: &quot;add&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;srcrgb&quot;: &quot;one&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;dstrgb&quot;: &quot;zero&quot;<br /><li>&nbsp; &nbsp; },<br /><li>&nbsp; &nbsp; &quot;vertex&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp; &quot;fragment&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp; &quot;attributes&quot;: [ &quot;Position&quot; ],<br /><li>&nbsp; &nbsp; &quot;samplers&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;DiffuseSampler&quot; }<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; &quot;uniforms&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;ProjMat&quot;,&nbsp; &nbsp;&quot;type&quot;: &quot;matrix4x4&quot;, &quot;count&quot;: 16, &quot;values&quot;: [ 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0 ] },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;InSize&quot;,&nbsp; &nbsp; &quot;type&quot;: &quot;float&quot;,&nbsp; &nbsp;&nbsp;&nbsp;&quot;count&quot;: 2,&nbsp;&nbsp;&quot;values&quot;: [ 1.0, 1.0 ] },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;OutSize&quot;,&nbsp; &nbsp;&quot;type&quot;: &quot;float&quot;,&nbsp; &nbsp;&nbsp;&nbsp;&quot;count&quot;: 2,&nbsp;&nbsp;&quot;values&quot;: [ 1.0, 1.0 ] }<br /><li>&nbsp; &nbsp; ]<br /><li>}</ol></div><em onclick="copycode($('code_Q3T'));">复制代码</em></div><br />
<font size="3">最后是替换掉原有的发光着色器，让它使用我们的着色器程序：<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">assets/minecraft/shaders/post/entity_outline.json</font></font>：</font><br />
<br /><div class="blockcode"><div id="code_UTX"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;targets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;final&quot;<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; &quot;passes&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;minecraft:main&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; ]<br /><li>}</ol></div><em onclick="copycode($('code_UTX'));">复制代码</em></div><br />
<font size="3">这里借助了一个 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">swap</font></font> 缓冲，是因为着色器程序不能往它读取的那个缓冲里面写入数据。</font><br />
<br />
<font size="3"><font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">F3 + T</font></font> 重载资源包，在视野内生成一个发光的实体。然后，你会发现品红色羊毛并没有显示我们屏幕上的内容。为什么？！这是因为，尽管已经在羊毛的模型当中设置了 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">&quot;ambientocclusion&quot;: false</font></font> 与 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">&quot;shade&quot;: false</font></font>，方块的材质仍然会不可避免地变暗。事实上，显示出来的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 通道的数值只有 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">0.96</font></font> 左右。因此我们不得不修改一下判断 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 通道大小的那行代码：</font><br />
<br /><div class="blockcode"><div id="code_ao3"><ol><li>-&nbsp; &nbsp;if (currentPixel.r == 1.0) {<br /><li>+&nbsp; &nbsp;if (currentPixel.r &gt; 0.9) {</ol></div><em onclick="copycode($('code_ao3'));">复制代码</em></div><br />
<font size="3">再次重载资源包。</font><br />
<br />
<font size="3"><img id="aimg_G82l1" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/03/1Z4BM2ToFdte6q8.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">现在屏幕上的内容显示在了原先的品红色羊毛上了。但是我们可以发现，品红色羊毛上显示的「品红色羊毛」仍然是那个魔幻的材质。如果想要做到「递归」那样的效果，应该怎么做呢？一种很简单的做法就是，在 post 文件里面复制粘贴，让该着色器程序多处理几遍：</font><br />
<br /><div class="blockcode"><div id="code_Si3"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;targets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;final&quot;<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; &quot;passes&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;minecraft:main&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;minecraft:main&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;minecraft:main&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; ]<br /><li>}</ol></div><em onclick="copycode($('code_Si3'));">复制代码</em></div><br />
<font size="3">重载资源包。现在看起来似乎好多了，但又好像有些不对的地方。</font><br />
<br />
<font size="3"><img id="aimg_znzBX" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/03/cF6PXC2fz3eniVO.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">其中，本应在地下矿洞中的水竟然显示到了屏幕上，方块选择边框也透过了指向的草方块。但是，原作者的着色器就是这个效果，后续改进是本人自己的私货，放至下一节。</font><br />
<br />
<font size="3"></font><br />
<br />
<font size="3"><img id="aimg_w5sGm" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/03/cF6PXC2fz3eniVO.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">这一现象其实原作者 <a href="https://www.mcbbs.net/plugin.php?id=link_redirect&target=https%3A%2F%2Fwww.reddit.com%2Fuser%2FSirBenet%2F" target="_blank">SirBenet</a> 在写教程的时候就有提及了，以下引自<a href="https://www.mcbbs.net/thread-916150-1-1.html" target="_blank">译文</a>的「着色器启用顺序」部分：</font><br />
<br /><div class="quote"><blockquote><font size="3"><ul type="1" class="litype_1"><li>Minecraft 渲染普通方块和实体到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font><li>Minecraft 渲染纯色的发光实体到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font><li>运行发光着色器（<font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">entity_outline.json</font></font>），其能够访问 &gt; <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 与 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 缓冲<li>Minecraft 渲染其他的东西（手、水、方块实体）到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font><li>Minecraft 把 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 覆盖到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 上<li>运行实体视角着色器，其能够访问 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 缓冲<br />
</ul></font><br />
<font size="3">通过发光着色器向 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 写入数据（第 3 步）似乎会破坏掉有关深度的信息，使得其他的东西（第 4 步）被渲染到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 的所有东西之上。</font></blockquote></div><br />
<font size="3">解决办法似乎很容易想到：不往 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font>，而是往 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 写入数据，不就可以了？我们把 post 文件中的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">&quot;outtarget&quot;</font></font> 从 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 改成 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font>，如下（为了简洁，我把递归的部分暂时先删掉了）：</font><br />
<br /><div class="blockcode"><div id="code_xqY"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;targets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;final&quot;<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; &quot;passes&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;final&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; ]<br /><li>}</ol></div><em onclick="copycode($('code_xqY'));">复制代码</em></div><br />
<font size="3">但这样又有了一个问题，游戏在第 4 步中渲染的东西（手、水、方块实体）会在第 5 步内被我们输出的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 覆盖掉，导致玩家看不到这些东西了。因此我们不能让 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 里全部填满内容，而是只修改对应品红色羊毛上显示内容的那几个像素，剩下的像素全部保留原样。有关保留原样，<a href="https://www.mcbbs.net/plugin.php?id=link_redirect&target=https%3A%2F%2Fwww.reddit.com%2Fuser%2FSirBenet%2F" target="_blank">SirBenet</a> 大佬在<a href="https://www.mcbbs.net/thread-916150-1-1.html" target="_blank">原版着色器指南</a>的跨帧储存信息一节已经有过讲解。</font><br />
<br />
<font size="3">修改着色器程序，加入新的采样器，用于访问我们过会儿复制的缓冲。</font><br />
<br /><div class="blockcode"><div id="code_EN7"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;samplers&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;DiffuseSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;BackupSampler&quot; }<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; ...<br /><li>}</ol></div><em onclick="copycode($('code_EN7'));">复制代码</em></div><br />
<font size="3">修改片段着色器：</font><br />
<br /><div class="blockcode"><div id="code_wqH"><ol><li>#version 120<br /><li><br /><li>uniform sampler2D DiffuseSampler;<br /><li>uniform sampler2D BackupSampler; // 新加的采样器<br /><li><br /><li>varying vec2 texCoord;<br /><li>varying vec2 oneTexel;<br /><li><br /><li>void main() {<br /><li>&nbsp; &nbsp; vec4 currentPixel = texture2D(DiffuseSampler, texCoord);<br /><li>&nbsp; &nbsp; if (currentPixel.r &gt; 0.9) {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;vec2 coordFromColor = currentPixel.gb;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;gl_FragColor = texture2D(DiffuseSampler, coordFromColor);<br /><li>&nbsp; &nbsp; } else {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;gl_FragColor = texture2D(BackupSampler, texCoord); // 改用新加的 BackupSampler 采样器，输出原有像素<br /><li>&nbsp; &nbsp; }<br /><li>}</ol></div><em onclick="copycode($('code_wqH'));">复制代码</em></div><br />
<font size="3">最后改一下 post 文件的 passes，在处理前把 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 缓冲复制到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">backup</font></font> 缓冲当中，然后指定 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">&quot;auxtargets&quot;</font></font>，使着色器程序能够访问 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">backup</font></font>：</font><br />
<br /><div class="blockcode"><div id="code_DOX"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;targets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;backup&quot;<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; &quot;passes&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;backup&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;auxtargets&quot;: [{ &quot;id&quot;: &quot;backup&quot;, &quot;name&quot;: &quot;BackupSampler&quot; }],<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;final&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; ]<br /><li>}</ol></div><em onclick="copycode($('code_DOX'));">复制代码</em></div><br />
<font size="3"><img id="aimg_nVzqH" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/04/RkpcCOhPU4mu1eK.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">重载后发现，（在视频设置为「流畅」时）树叶莫名变粉了。以下是本人的<strong>臆测</strong>，需要进一步证实或否定，请不要轻信：</font><br />
<br /><div class="quote"><blockquote><font size="3">树叶中有部分像素是透明的。之前这一部分像素绘制在了 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 缓冲中，游戏会在显示时把它们显示为纯黑色。而现在我们将它绘制到了 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 缓冲中，游戏正常处理这些透明像素，导致 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 缓冲下层的品红色羊毛的材质显示了出来，树叶变成了「粉色」。</font></blockquote></div><br />
<font size="3">因此，在片段着色器中，如果坐标对应 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">gb</font></font> 的像素是透明的，我们应当改为输出黑色像素，这样才能显示出和原先树叶一致的效果。</font><br />
<br /><div class="blockcode"><div id="code_mps"><ol><li>#version 120<br /><li><br /><li>uniform sampler2D DiffuseSampler;<br /><li>uniform sampler2D BackupSampler;<br /><li><br /><li>varying vec2 texCoord;<br /><li>varying vec2 oneTexel;<br /><li><br /><li>void main() {<br /><li>&nbsp; &nbsp; vec4 currentPixel = texture2D(DiffuseSampler, texCoord);<br /><li>&nbsp; &nbsp; if (currentPixel.r &gt; 0.9) {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;vec2 coordFromColor = currentPixel.gb;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;vec2 ans = texture2D(DiffuseSampler, coordFromColor);<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;// 在此处加一个判断，看对应像素是不是透明的。<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (ans[3] &lt; 1) {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// 是的话，就输出黑色像素。<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;} else {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// 否则仍跟原来一样，输出对应像素。<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;gl_FragColor = ans;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; } else {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;gl_FragColor = texture2D(BackupSampler, texCoord);<br /><li>&nbsp; &nbsp; }<br /><li>}</ol></div><em onclick="copycode($('code_mps'));">复制代码</em></div><br />
<font size="3"><img id="aimg_dk6I0" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/04/uwZyXs7qohIJHjL.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">现在似乎正常了：屏幕中的水、玩家的手、羊毛中的树叶都正常显示了。</font><br />
<br />
<font size="3">现在剩下的只有递归显示了。这时的递归比之前要麻烦一些。「屏幕方块」上的内容是绘制在 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 缓冲的，而内容的来源却是 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 缓冲，因此我们需要在递归时，让片段着色器检测 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 缓冲中像素是否符合品红色羊毛材质的颜色，符合的话则读取 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 缓冲中的对应像素。我们规定，使用默认的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">DiffuseSampler</font></font> 采样器获取可能带有品红色羊毛材质的缓冲，使用新定义的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">SourceSampler</font></font> 采样器来获取带有玩家屏幕内容的缓冲（即 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 缓冲）。</font><br />
<br />
<font size="3">在着色器程序的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">&quot;samplers&quot;</font></font> 中补上要新定义的 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">SourceSampler</font></font>：</font><br />
<br /><div class="blockcode"><div id="code_kK9"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;samplers&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;DiffuseSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;BackupSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{ &quot;name&quot;: &quot;SourceSampler&quot; }<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; ...<br /><li>}</ol></div><em onclick="copycode($('code_kK9'));">复制代码</em></div><br />
<font size="3">然后魔改一下片段着色器：</font><br />
<br /><div class="blockcode"><div id="code_xvg"><ol><li>#version 120<br /><li><br /><li>uniform sampler2D DiffuseSampler;<br /><li>uniform sampler2D BackupSampler;<br /><li>uniform sampler2D SourceSampler; // 定义个新采样器<br /><li><br /><li>varying vec2 texCoord;<br /><li>varying vec2 oneTexel;<br /><li><br /><li>void main() {<br /><li>&nbsp; &nbsp; vec4 currentPixel = texture2D(DiffuseSampler, texCoord);<br /><li>&nbsp; &nbsp; if (currentPixel.r &gt; 0.9) {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;vec2 coordFromColor = currentPixel.gb;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;vec4 ans = texture2D(SourceSampler, coordFromColor); // 改成从 SourceSampler 采样器获取屏幕内容<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (ans[3] &lt; 1) {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;} else {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;gl_FragColor = ans;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; } else {<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);<br /><li>&nbsp; &nbsp; }<br /><li>}</ol></div><em onclick="copycode($('code_xvg'));">复制代码</em></div><br />
<font size="3">最后，修改 post 文件，完成递归：</font><br />
<br /><div class="blockcode"><div id="code_IE1"><ol><li>{<br /><li>&nbsp; &nbsp; &quot;targets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&quot;backup&quot;<br /><li>&nbsp; &nbsp; ],<br /><li>&nbsp; &nbsp; &quot;passes&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;backup&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;auxtargets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;backup&quot;, &quot;name&quot;: &quot;BackupSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;minecraft:main&quot;, &quot;name&quot;: &quot;SourceSampler&quot; }<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;],<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;minecraft:main&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;backup&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;auxtargets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;backup&quot;, &quot;name&quot;: &quot;BackupSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;minecraft:main&quot;, &quot;name&quot;: &quot;SourceSampler&quot; }<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;],<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;final&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;backup&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;auxtargets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;backup&quot;, &quot;name&quot;: &quot;BackupSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;minecraft:main&quot;, &quot;name&quot;: &quot;SourceSampler&quot; }<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;],<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;backup&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;auxtargets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;backup&quot;, &quot;name&quot;: &quot;BackupSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;minecraft:main&quot;, &quot;name&quot;: &quot;SourceSampler&quot; }<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;],<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;final&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;backup&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;screens&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;auxtargets&quot;: [<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;backup&quot;, &quot;name&quot;: &quot;BackupSampler&quot; },<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; { &quot;id&quot;: &quot;minecraft:main&quot;, &quot;name&quot;: &quot;SourceSampler&quot; }<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;],<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;final&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;swap&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;name&quot;: &quot;blit&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;intarget&quot;: &quot;swap&quot;,<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;outtarget&quot;: &quot;final&quot;<br /><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br /><li>&nbsp; &nbsp; ]<br /><li>}</ol></div><em onclick="copycode($('code_IE1'));">复制代码</em></div><br />
<font size="3">（这是真的长…）</font><br />
<br />
<font size="3"><img id="aimg_Guz6U" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" src="https://i.loli.net/2019/10/04/XzMopyrC13Id4D9.png" onmouseover="img_onmouseoverfunc(this)" onload="thumbImg(this)" border="0" alt="" /></font><br />
<br />
<font size="3">那么，本节我们到底都做了些什么呢？</font><br />
<br />
<font size="3"><ul><li>为了解决水的透视，把输出从 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">minecraft:main</font></font> 改到 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font>。<font size="3"><ul><li>为此，加入了 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">BackupSampler</font></font>，用于访问 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">final</font></font> 中原有的像素；<li>处理了一下透明色，避免树叶等方块变粉；<li>为了递归能访问屏幕上的像素，又加了个 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">SourceSampler</font></font>。<br />
</ul></font><br />
</ul></font><br />
<font size="3">经过如此一通改良的屏幕方块，总算是避免了原先水等东西的透视。但它仍有一个问题，chyx 在本帖<a href="https://www.mcbbs.net/forum.php?mod=redirect&amp;goto=findpost&amp;ptid=917679&amp;pid=15685643" target="_blank">板凳</a>就有指出：</font><br />
<br /><div class="quote"><blockquote><font size="3">也不是没用过这个…但是用了之后所有红色分量够高的地方都在闪………<br />
包括白色，红色什么的地方……<br />
倒是这个方块自己在天黑之后就不认了XD</font></blockquote></div><br />
<font size="3">在上图中我们也能发现，本身应是白色的花、应有白色发光的盔甲架的白色部分都变了。这是因为我们的片段着色器中只判定了 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 的大小是否 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">&gt; 0.9</font></font>，因此很容易误伤红色分量够高的像素。</font><br />
<br />
<font size="3">每一个像素实际上是一个 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">vec4</font></font> 向量，目前我们只利用到了 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">rgb</font></font> 三个分量。如果把 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">a</font></font> 分量也用上，将其与 <font style="background-color:#ebddc0"><font face="Monaco,Consolas,'Lucida Console','Courier New',serif">r</font></font> 分量结合起来一同判定是否应当修改这个像素，是不是会更加准确呢？</font><br />
<br />
<font size="3">下一节将会以此思路，重新对「屏幕方块」进行改良。</font><br />
<br />
<font size="3"></font><br />
<br />
<font size="3">然后，又咕了。</font><br />
<br />
[groupid=546]Command Block Logic[/groupid]<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>wshycaa&nbsp; &nbsp; <b>时间: </b>2019-10-4 00:39<br />
坐等屏幕着色器完整版出炉~~<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>chyx&nbsp; &nbsp; <b>时间: </b>2019-10-4 05:44<br />
也不是没用过这个…但是用了之后所有红色分量够高的地方都在闪………<br />
包括白色，红色什么的地方……<br />
倒是这个方块自己在天黑之后就不认了XD<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>mc能吃吗&nbsp; &nbsp; <b>时间: </b>2019-10-4 10:11<br />
XD?为什么我想到了刘慈欣的那个什么量子计算机里的宇宙模型。。<br />
<br />
话说可以做镜子出来。。。吧<br />
还有多人游戏复制其他玩家的视角？强大XD<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>chyx&nbsp; &nbsp; <b>时间: </b>2019-10-4 16:47<br />
<div class="quote"><blockquote><font color="#999999">mc能吃吗 发表于 2019-10-4 10:11</font><br />
<font color="#999999">XD?为什么我想到了刘慈欣的那个什么量子计算机里的宇宙模型。。<br />
<br />
话说可以做镜子出来。。。吧<br />
</font></blockquote></div><br />
做你所说的效果估计得高频tp。<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>神经幺&nbsp; &nbsp; <b>时间: </b>2020-3-6 20:26<br />
不愧是spg!普通人根本做不到的事情,轻轻松松就可以做出来!实在是太厉害了!(咕咕咕)<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>夜·北冥&nbsp; &nbsp; <b>时间: </b>2020-4-29 14:25<br />
这个我感觉跟摄像头差不多，就是可以被看到<hr noshade size="2" width="100%" color="#808080">
<b>作者: </b>若梦丶浮生&nbsp; &nbsp; <b>时间: </b>2020-12-12 19:28<br />
提示: <em>作者被禁止或删除 内容自动屏蔽</em>

<br /><br /><br /><br /><hr noshade size="2" width="100%" color="BORDERCOLOR">
<table cellspacing="0" cellpadding="0" border="0" width="95%" align="center" style="font-size: SMFONTSIZE; font-family: SMFONT">
<tr><td>欢迎光临 Minecraft(我的世界)中文论坛 (https://www.mcbbs.net/)</td>
<td align="right">
Powered by Discuz! X3.5</td></tr></table>

</body>
</html>